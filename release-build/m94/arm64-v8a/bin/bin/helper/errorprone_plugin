#!/usr/bin/env python
#
# This file was generated by build/android/gyp/create_java_binary_script.py

import argparse
import os
import sys

self_dir = os.path.dirname(__file__)
classpath = ["../../../lib.java/tools/android/errorprone_plugin/errorprone_plugin.jar", "../../../lib.java/third_party/android_deps/com_google_auto_service_auto_service_annotations.jar", "../../../lib.java/third_party/android_deps/com_google_code_findbugs_jsr305.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_error_prone_annotations.jar", "../../../lib.java/third_party/android_deps/com_google_guava_failureaccess.jar", "../../../lib.java/third_party/android_deps/com_google_guava_listenablefuture.jar", "../../../lib.java/third_party/android_deps/com_google_j2objc_j2objc_annotations.jar", "../../../lib.java/third_party/android_deps/org_checkerframework_checker_qual.jar", "../../../lib.java/third_party/android_deps/com_google_guava_guava.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_error_prone_annotation.jar", "../../../lib.java/third_party/android_deps/com_github_ben_manes_caffeine_caffeine.jar", "../../../lib.java/third_party/android_deps/com_github_kevinstern_software_and_algorithms.jar", "../../../lib.java/third_party/android_deps/com_google_auto_value_auto_value_annotations.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_javac.jar", "../../../lib.java/third_party/android_deps/org_eclipse_jgit_org_eclipse_jgit.jar", "../../../lib.java/third_party/android_deps/io_github_java_diff_utils_java_diff_utils.jar", "../../../lib.java/third_party/android_deps/org_checkerframework_dataflow_shaded.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_error_prone_check_api.jar", "../../../lib.java/third_party/android_deps/com_google_auto_auto_common.jar", "../../../lib.java/third_party/android_deps/com_google_code_findbugs_jFormatString.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_error_prone_type_annotations.jar", "../../../lib.java/third_party/android_deps/com_google_protobuf_protobuf_java.jar", "../../../lib.java/third_party/android_deps/org_pcollections_pcollections.jar", "../../../lib.java/third_party/android_deps/com_google_errorprone_error_prone_core.jar"]
extra_program_args = []
java_path = '../../../../../../../third_party/jdk/current/bin/java'
if os.getcwd() != self_dir:
  offset = os.path.relpath(self_dir, os.getcwd())
  fix_path = lambda p: os.path.normpath(os.path.join(offset, p))
  classpath = [fix_path(p) for p in classpath]
  java_path = fix_path(java_path)
java_cmd = [java_path]
# This is a simple argparser for jvm, jar, and classpath arguments.
parser = argparse.ArgumentParser(add_help=False)
parser.add_argument('--jar-args')
parser.add_argument('--jvm-args')
parser.add_argument('--classpath')
# Test_runner parses the classpath for sharding junit tests.
parser.add_argument('--print-classpath', action='store_true',
                    help='Prints the classpass. Used by test_runner.')
known_args, unknown_args = parser.parse_known_args(sys.argv[1:])

if known_args.print_classpath:
  sys.stdout.write(':'.join(classpath))
  sys.exit(0)

if known_args.jvm_args:
  jvm_arguments = known_args.jvm_args.strip('"').split()
  java_cmd.extend(jvm_arguments)
if known_args.jar_args:
  jar_arguments = known_args.jar_args.strip('"').split()
  if unknown_args:
    raise Exception('There are unknown arguments')
else:
  jar_arguments = unknown_args

if known_args.classpath:
  classpath += [known_args.classpath]


java_cmd.extend(
    ['-classpath', ':'.join(classpath), '-enableassertions', "<ignore>"])
java_cmd.extend(extra_program_args)
java_cmd.extend(jar_arguments)
os.execvp(java_cmd[0], java_cmd)
